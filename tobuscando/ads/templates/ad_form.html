{% extends 'base.html' %}

{% load staticfiles %}
{% load mptt_tags %}
{% load bootstrap3 %}

{% block js %}
<script type="text/javascript" src="{% static 'js/products.js' %}"></script>
{% endblock js %}


{% block content %}

<h2>Faça seu anúncio grátis!</h2>


{% if form_ad.is_multipart %}
<form enctype="multipart/form-data" id="id_form_ad" name="form_ad" action="." method="POST">
    {% else %}
    <form id="id_form_ad" name="form_ad" action="." method="POST">
        {% endif %}
        {% csrf_token %}

        <div class="well">
            <div class="clearfix">
                <div class="form-group">
                    {% bootstrap_label form_ad.category.label %}
                    <ul id="category" class="list-group col-sm-3">
                        {% recursetree categories %}
                        <li id="dropdown-nav-{{ node.pk }}" class="list-group-item">
                            <label for="id_category_{{ node.pk }}">
                                {{ node.level }}
                                {{ node.name }}
                                {% if form_ad.category.value|add:"0" == node.pk|add:"0" %}
                                <input checked="checked" id="id_category_{{ node.pk }}" name="category" type="radio" value="{{ node.pk }}" class="radio-category">
                                {% else %}
                                <input id="id_category_{{ node.pk }}" name="category" type="radio" value="{{ node.pk }}" class="radio-category">
                                {% endif %}
                            </label>

                            {% if not node.is_leaf_node %}
                            <ul id="dropdown-nav-{{ node.pk }}" class="list-group dropdown-nav col-sm-12">
                                {{ children }}
                            </ul>
                            {% endif %}
                            {% endrecursetree %}
                        </li>
                    </ul>
                </div>

                {{ form_ad.category.errors }}
            </div>

            <div id="metaoptions" class="clearfix">
                {% if form_ad.category.value %}
                {% include 'categorymeta_form.html' %}
                {% endif %}
            </div>

            <div class="clearfix">
                {% for field in form_ad %}
                {% if field.name != 'category' %}
                <div class="cleafix">
                    {% bootstrap_field field %}
                    {% bootstrap_form_errors form_ad %}
                </div>
                {% endif %}
                {% endfor %}
            </div>

            {% buttons %}
            <br>
            <button type="submit" class="btn btn-primary btn-lg">Cadastrar</button>
            {% endbuttons %}

        </div>
    </form>
    {% endblock content %}
